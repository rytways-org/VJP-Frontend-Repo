"use strict";(self.webpackChunkcosting=self.webpackChunkcosting||[]).push([[4147],{44147:function(e,t,r){r.r(t),r.d(t,{default:function(){return k}});var n=r(1413),a=r(74165),s=r(42982),o=r(15861),l=r(70885),i=r(72791),u=r(60057),c=(r(38595),r(30717)),d=r(89743),m=r(2677),p=r(61134),Z=r(97829),x=r(73728),f=r(4349),h=r(59434),g=r(21216),y=r(80184);var j=function(e){var t=(0,h.I0)(),r=(0,i.useState)({}),a=(0,l.Z)(r,2),s=a[0],o=a[1],u=(0,h.v9)((function(e){return[e.alertProps.showAlert,e.alertProps.alertMessage,e.alertProps.alertVariant]})),j=(0,l.Z)(u,3),v=j[0],N=(j[1],j[2],(0,i.useState)()),b=(0,l.Z)(N,2),C=b[0],P=(b[1],(0,p.cI)({defaultValues:(0,n.Z)({},C)})),S=P.register,q=P.handleSubmit,F=P.formState.errors,D=(P.watch,P.setError,P.clearErrors,P.setValue,P.reset);return(0,i.useEffect)((function(){D(e.defaultValues)}),[e.defaultValues]),(0,y.jsx)(c.Z,{className:Z.Z.formcon,children:(0,y.jsxs)(d.Z,{style:{backgroundColor:g.Z.colors.dgc,borderRadius:"1em",padding:".5rem 1rem"},children:[(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Material Category"}),(0,y.jsxs)(c.Z.Select,(0,n.Z)((0,n.Z)({type:"text",id:"category",name:"category"},S("category")),{},{onChange:function(t){e.loadCatMaterials(t.target.value)},className:Z.Z.formBorder,children:[(0,y.jsx)("option",{value:"",children:"Select"}),(0,y.jsx)("option",{value:"Raw_Materials",children:"Raw Materials"}),(0,y.jsx)("option",{value:"Office_Supplies",children:"Office Supplies"}),(0,y.jsx)("option",{value:"Electronics",children:"Electronics"}),(0,y.jsx)("option",{value:"Consumables",children:"Consumables"})]})),F.materialId&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:F.materialId.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Material"}),(0,y.jsx)(c.Z.Select,(0,n.Z)((0,n.Z)({type:"text",id:"materialId",name:"materialId"},S("materialId",{required:"Material is Required"})),{},{onChange:function(t){e.loadMaterials(t.target.value)},className:Z.Z.formBorder,children:e.materials.map((function(e,t){var r=e.value,n=e.label;return(0,y.jsx)("option",{value:r,children:n})}))})),F.materialId&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:F.materialId.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Uom"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"text",id:"uom",name:"uom",defaultValue:e.loadedMaterial.uom,disabled:!0,readOnly:!0},S("uom")),{},{className:Z.Z.formBorder,style:{backgroundColor:"transparent"}})),F.uome&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:F.uom.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Unit Price"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"text",id:"unitPrice",name:"unitPrice"},S("unitPrice")),{},{defaultValue:e.loadedMaterial.lastPurchasePrice,className:Z.Z.formBorder})),F.unitPrice&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:F.unitPrice.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"amount",children:"HSN/SAC Code"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"text",id:"hsnCode",name:"hsnCode"},S("hsnCode")),{},{className:Z.Z.formBorder})),F.hsnCode&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:F.hsnCode.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"GST Percentage"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"text",id:"gst",name:"gst"},S("gst")),{},{defaultValue:e.loadedMaterial.gst,className:Z.Z.formBorder})),F.gst&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:F.gst.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Cost Center"}),(0,y.jsxs)(c.Z.Select,(0,n.Z)((0,n.Z)({type:"text",id:"costCenter",name:"costCenter"},S("costCenter",{required:"Line No is Required"})),{},{className:Z.Z.formBorder,children:[(0,y.jsx)("option",{value:"0",children:"Select"}),(0,y.jsx)("option",{value:"1",children:"Cost Center 1"}),(0,y.jsx)("option",{value:"2",children:"Cost Center 2"}),(0,y.jsx)("option",{value:"3",children:"Cost Center 3"})]})),F.costCenter&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:F.costCenter.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"quantity",children:"Quantity"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"number",id:"quantity",name:"quantity"},S("quantity",{required:"Quantity is Required"})),{},{min:1,step:1,max:e.maxQty,className:Z.Z.formBorder})),F.quantity&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:F.quantity.message})]},"quantity")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"quantity",children:"Due Date"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"date",id:"dueDate",name:"dueDate"},S("dueDate")),{},{min:1,step:1,max:e.maxQty,className:Z.Z.formBorder})),F.dueDate&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:F.dueDate.message})]},"quantity")}),(0,y.jsxs)(m.Z,{md:1,children:[" ",(0,y.jsx)("a",{children:(0,y.jsx)(x.qVg,{size:38,className:Z.Z.btnextra,onClick:q((function(r){var n,a,l;if(0!=e.loadedMaterial.materialId){var i=e.data.find((function(t){return t.material.materialId===e.loadedMaterial.materialId}));o(i)}else o({});!(null!==s&&void 0!==s&&null!==(n=s.material)&&void 0!==n&&n.materialId)>0?(""===r.unitPrice&&(r.unitPrice=e.loadedMaterial.lastPurchasePrice),r.gst=e.loadedMaterial.gst,r.material=e.loadedMaterial,r.materialRequestId=(1e4*Math.random()).toFixed(0),r.requests=1,r.isRequest="No",r.requestItems=[],r.poQty=r.quantity,r.specs="",r.amount=r.unitPrice*r.quantity,r.gstAmt=(r.unitPrice*r.poQty*.01*r.gst).toFixed(2),e.savePo(r,"add"),D()):(a="Cannot Add Same Material Please Edit Quantity",l="success",t(f.I.showAlertHandler({showAlert:!v,alertMessage:a,alertVariant:l})),D())})),hover:!0})})]})]})})},v=r(23118),N=r(23853),b=function(e,t,r){return[{title:"Item Name",align:"center",render:function(e){return(0,y.jsx)(y.Fragment,{children:""===e.specs?(0,y.jsx)("span",{children:e.material.materialName}):(0,y.jsxs)("span",{children:[e.material.materialName,"(",e.specs,")"]})})}},{title:"Specs",align:"center",render:function(t){return(0,y.jsx)(N.vPQ,{style:{cursor:"pointer"},onClick:e(t,"EditEntry")})}},{title:"Due Date",align:"center",render:function(e){return(0,y.jsx)("span",{children:e.dueDate})}},{title:"Unit Price",align:"center",render:function(e){var r="unitPrice".concat(e.purchaseRequestId);return(0,y.jsx)(c.Z.Group,{children:(0,y.jsx)(c.Z.Control,{type:"text",id:r,name:r,defaultValue:e.unitPrice,onBlur:function(r){return t("unitPrice",r.target.value,e)}})},"producedQty")}},{title:"Quantity",align:"center",render:function(r){var n="qty".concat(r.purchaseRequestId);return(0,y.jsx)("span",{children:1==r.requests?(0,y.jsx)(c.Z.Group,{children:(0,y.jsx)(c.Z.Control,{type:"text",id:n,name:n,defaultValue:r.poQty,onBlur:function(e){return t("qty",e.target.value,r)}})},"producedQty"):(0,y.jsx)("span",{style:{cursor:"pointer",color:"blue"},onClick:e(r,"FurnanceForm"),children:r.poQty})})}},{title:"Uom",align:"center",render:function(e){return(0,y.jsx)("span",{children:e.material.uom})}},{title:"Gst Perc",align:"center",render:function(e){"gst".concat(e.purchaseRequestId);return(0,y.jsx)("span",{children:e.gst})}},{title:"Gst",align:"center",render:function(e){return(0,y.jsx)("span",{children:e.gstAmt})}},{title:"Amount",align:"center",render:function(e){return(0,y.jsx)("span",{children:e.amount})}},{title:"Remove",align:"center",render:function(t){return(0,y.jsx)(N.Ybf,{style:{cursor:"pointer"},onClick:e(t,"delete")})}}]};var C=function(e){var t=(0,i.useState)(),r=(0,l.Z)(t,2),a=r[0],o=(r[1],(0,p.cI)({defaultValues:(0,n.Z)({},a)})),u=o.register,x=(o.handleSubmit,o.formState.errors),f=o.watch,h=(o.setError,o.clearErrors,o.setValue,o.reset),j=f(["roundOff","notes"]),v=(0,i.useState)({roundOff:"0",notes:""}),N=(0,l.Z)(v,2);return N[0],N[1],(0,i.useEffect)((function(){e.saveValues(j)}),(0,s.Z)(j)),(0,i.useEffect)((function(){h(e.defaultValues)}),[e.defaultValues]),(0,y.jsx)(c.Z,{className:Z.Z.formcon,children:(0,y.jsxs)(d.Z,{style:{backgroundColor:g.Z.colors.dg,borderRadius:"1em",padding:".5rem 1rem"},children:[(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"CGst Amount"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"textarea",id:"cGst",name:"cGst",defaultValue:(e.gstAmt/2).toFixed(2)},u("cGst")),{},{className:Z.Z.formBorder})),x.cGst&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:x.cGst.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"SGst Amount"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"textarea",id:"sGst",name:"sGst",defaultValue:(e.gstAmt/2).toFixed(2)},u("sGst")),{},{className:Z.Z.formBorder})),x.sGst&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:x.sGst.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"IGst Amount"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"textarea",id:"iGst",name:"iGst",defaultValue:e.igstAmt.toFixed(2)},u("iGst")),{},{className:Z.Z.formBorder})),x.iGst&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:x.iGst.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Total Gst"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"textarea",id:"totalGst",name:"totalGst",defaultValue:Number(e.gstAmt+e.igstAmt).toFixed(2)},u("totalGst")),{},{className:Z.Z.formBorder})),x.totalGst&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:x.totalGst.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Gross Amount"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"textarea",id:"grossAmt",name:"grossAmt",defaultValue:e.gross},u("grossAmt")),{},{className:Z.Z.formBorder})),x.grossAmt&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:x.grossAmt.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Net Amount"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"textarea",id:"netAmt",name:"netAmt",defaultValue:e.gstAmt+e.gross},u("netAmt")),{},{style:{backgroundColor:"transparent"}})),x.netAmt&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:x.netAmt.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:3},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Round-OFF Amt"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({type:"textarea",id:"roundOff",name:"roundOff",defaultValue:0},u("roundOff")),{},{className:Z.Z.formBorder})),x.roundOff&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:x.roundOff.message})]},"lineNo")}),(0,y.jsx)(m.Z,{md:{span:6},children:(0,y.jsxs)(c.Z.Group,{children:[(0,y.jsx)(c.Z.Label,{htmlFor:"lineNo",children:"Notes"}),(0,y.jsx)(c.Z.Control,(0,n.Z)((0,n.Z)({as:"textarea",id:"notes",name:"notes",defaultValue:""},u("notes")),{},{className:Z.Z.formBorder})),x.notes&&(0,y.jsx)(c.Z.Text,{className:"text-danger",children:x.notes.message})]},"lineNo")})]})})},P=r(99355),S=r(21229);var q=function(e){e.data&&e.data;var t=(0,i.useState)({}),r=(0,l.Z)(t,2),u=r[0],c=(r[1],(0,i.useState)(e.data?e.data:[])),d=(0,l.Z)(c,2),m=(d[0],d[1],(0,i.useState)()),p=(0,l.Z)(m,2),Z=(p[0],p[1],(0,i.useState)(e.materials)),x=(0,l.Z)(Z,2),f=x[0],h=x[1],g=(0,i.useState)({materialName:"",uom:""}),N=(0,l.Z)(g,2),q=N[0],F=N[1],D=(0,S.ZP)({data:[]}),I=(D.get,D.post),A=D.response,G=(D.loading,D.error,function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,I(P.ZP+"/material/getById",{materialId:t});case 3:r=e.sent,A.ok?F((function(e){return(0,n.Z)({},r)})):F("Not Available"),console.log(q);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),R=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(P.ZP+"/material/loadOptionsByCategory",{category:t});case 2:r=e.sent,A.ok&&h([{value:"",label:"Select"}].concat((0,s.Z)(r)));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,y.jsxs)("div",{style:{padding:"0 1.5rem"},children:[(0,y.jsx)(j,{loadMaterials:G,loadCatMaterials:R,loadedMaterial:q,materials:f,defaultValues:u,savePo:e.savePo,data:e.data}),(0,y.jsx)(v.Z,{data:e.data,cols:b((function(t,r){return function(){"delete"===r?e.handleEdit(r,"",t):e.showFormHandler(t,r)}}),e.handleEdit)}),(0,y.jsx)(C,{gstAmt:e.gstAmt,gross:e.gross,net:e.net,igstAmt:e.igstAmt,terms:e.terms,saveValues:e.finalSubmit})]})},F=r(95316),D=r(79747),I=function(e,t){return[{title:"Item Name",align:"center",render:function(e){return(0,y.jsx)("span",{children:e.material.materialName})}},{title:"Request No",align:"center",render:function(e){return(0,y.jsx)("span",{children:e.purchaseRequest.requestNo})}},{title:"Department",align:"center",render:function(e){return(0,y.jsx)("span",{children:e.purchaseRequest.department})}},{title:"Request Person",align:"center",render:function(e){return(0,y.jsx)("span",{children:e.purchaseRequest.user.userName})}},{title:"Quantity",align:"center",render:function(t){var r="qty".concat(t.materialQty);return(0,y.jsx)("span",{children:(0,y.jsx)(c.Z.Group,{children:(0,y.jsx)(c.Z.Control,{type:"text",id:r,name:r,defaultValue:t.poQty,onBlur:function(r){return e(r.target.value,t)}})},"producedQty")})}},{title:"Uom",align:"center",render:function(e){"gst".concat(e.purchaseRequestId);return(0,y.jsx)("span",{children:e.material.uom})}},{title:"Gst Perc",align:"center",render:function(e){"gst".concat(e.purchaseRequestId);return(0,y.jsx)("span",{children:e.material.gst})}}]},A=function(e){console.log(e.matReqs);var t=(0,i.useState)(),r=(0,l.Z)(t,2);r[0],r[1];return(0,y.jsx)(D.Z,{children:(0,y.jsx)(v.Z,{data:e.matReqs,cols:I((function(t,r){e.handleEditRequests("QuantityEdit",t,r,e.rowData)}),e.isDefault)})})},G=r(2144);function R(e,t){t.errors,t.setError,t.clearErrors;e[0]>0&&console.log(e[0])}var w=function(e){return(0,y.jsx)(G.Z,{children:(0,y.jsx)(u.Z,{template:{heading:"Edit Specifications",fields:[{title:"Edit Specs",type:"text",name:"specs",contains:"text",inpprops:{}}]},rowwise:2,validate:R,onSubmit:function(t){e.handleEditRequests("SpecsEdit",t.specs,"",e.rowData)},onCancel:e.onCancel,defaultValues:e.rowData,buttonName:"Save"})})},E=r(50654),O={upper:{padding:"0"},upperRow:{margin:".5rem .5rem 0 .5rem",padding:"0 1rem 0 1rem",backgroundColor:g.Z.colors.dg,borderRadius:"1rem"},uppertitle:{borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:g.Z.colors.ttle}};var k=function(e){var t=(0,S.ZP)({data:[]}),r=t.get,c=t.post,d=t.response,m=(t.loading,t.error,(0,i.useState)(e.reqNo)),p=(0,l.Z)(m,2),Z=p[0],x=p[1],f=(0,i.useState)(0),h=(0,l.Z)(f,2),g=h[0],j=h[1],v=(0,i.useState)(e.selectedItems?e.selectedItems:[]),N=(0,l.Z)(v,2),b=N[0],C=N[1],I=(0,i.useState)([]),G=(0,l.Z)(I,2),R=G[0],k=G[1],Q=(0,i.useState)(e.selected?e.selected:{poNo:Z}),T=(0,l.Z)(Q,2),B=T[0],V=T[1],M=(0,i.useState)([{value:"",label:"Select"}]),_=(0,l.Z)(M,2),L=_[0],H=_[1],U=(0,i.useState)([{value:"",label:"Select"}]),z=(0,l.Z)(U,2),Y=z[0],J=z[1],W=(0,i.useState)([{value:"",label:"Select"}]),K=(0,l.Z)(W,2),X=K[0],$=K[1],ee=(0,i.useState)(!1),te=(0,l.Z)(ee,2),re=te[0],ne=te[1],ae=(0,i.useState)(0),se=(0,l.Z)(ae,2),oe=se[0],le=se[1],ie=(0,i.useState)({termsAndConId:"",roundOff:0,notes:""}),ue=(0,l.Z)(ie,2),ce=ue[0],de=ue[1],me=(0,i.useState)([{value:"",label:"Select"}]),pe=(0,l.Z)(me,2),Ze=pe[0],xe=pe[1],fe=(0,i.useState)([]),he=(0,l.Z)(fe,2),ge=(he[0],he[1]),ye=(0,i.useState)({showForm:!1,selectedForm:(0,y.jsx)(y.Fragment,{}),selectedItem:{id:0,productName:"",cusName:"",part:"",quantity:"",cost:""}}),je=(0,l.Z)(ye,2),ve=je[0],Ne=je[1],be=(0,i.useCallback)((0,o.Z)((0,a.Z)().mark((function e(){var t,n,o,l,i,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(P.ZP+"/poMaster/listAll",{id:Math.random(),loadTime:Date().toLocaleString()});case 2:return t=e.sent,e.next=5,r(P.ZP+"/supplier/loadOptions");case 5:return n=e.sent,e.next=8,r(P.ZP+"/company/loadOptions");case 8:return o=e.sent,console.log(o),e.next=12,c(P.ZP+"/poMaster/loadReqNo",{random:Math.random()});case 12:l=e.sent,i=(new Date).getFullYear()-2e3,u=(new Date).getMonth()+1,d.ok&&(ge(t),H([].concat((0,s.Z)(L),(0,s.Z)(n))),J([].concat((0,s.Z)(Y),(0,s.Z)(o))),u>=4&&x("".concat(i,"/").concat(i+1,"-0000").concat(Number(l)+1)),u<4&&x("".concat(i-1,"/").concat(i,"-0000").concat(Number(l)+1)));case 16:case"end":return e.stop()}}),e)}))),[r,d]);(0,i.useEffect)((function(){be()}),[]);var Ce=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,r){var n,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(P.ZP+"/matrialPrItems/multipleRequests",{ids:t});case 2:if(n=e.sent,d.ok){for(o=0;o<n.length;o++)n[o].poQty=r.requestQty[o];k((function(e){return(0,s.Z)(n)})),k((function(e){return console.log(e),e})),console.log(R)}case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Pe=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,r,n,s){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"QuantityEdit"===t?(n.poQty=r,console.log(R),k((function(e){return e.map((function(e){return e.materialRequestId===n.materialRequestId?n:e}))})),console.log(R),s.requestQty[s.requestItems.findIndex((function(e){return e===n.materialRequestId}))]=r,s.poQty=s.requestQty.map((function(e){return e})).reduce((function(e,t){return Number(e)+Number(t)})),s.amount=s.unitPrice*s.poQty,s.gstAmt=(s.unitPrice*s.poQty*.01*s.gst).toFixed(2),Me("update",s)):"SpecsEdit"===t&&(s.specs=r,Me("SpecsEdit",s));case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),Se=function(){Ne((0,n.Z)((0,n.Z)({},ve),{},{showForm:!1,selectedForm:"",selectedItem:(0,n.Z)((0,n.Z)({},ve.selectedItem),{id:0,productName:"",cusName:"",part:"",quantity:"",cost:""})}))},qe=(0,i.useState)(b.length>0?b.map((function(e){return e.gstAmt})).reduce((function(e,t){return Number(e)+Number(t)})):0),Fe=(0,l.Z)(qe,2),De=Fe[0],Ie=Fe[1],Ae=(0,i.useState)(b.length>0?b.map((function(e){return e.amount})).reduce((function(e,t){return Number(e)+Number(t)})):0),Ge=(0,l.Z)(Ae,2),Re=Ge[0],we=Ge[1],Ee=(0,i.useState)(De+Re),Oe=(0,l.Z)(Ee,2),ke=Oe[0],Qe=Oe[1],Te=(0,i.useContext)(E.Z).userId,Be=(0,i.useCallback)((0,o.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(P.ZP+"/material/loadOptions");case 2:return t=e.sent,e.next=5,r(P.ZP+"/terms/loadOptions");case 5:n=e.sent,xe([].concat((0,s.Z)(Ze),(0,s.Z)(t))),$([].concat((0,s.Z)(X),(0,s.Z)(n)));case 8:case"end":return e.stop()}}),e)}))),[r,d]);(0,i.useEffect)((function(){Be()}),[]);var Ve={heading:"PO Entry",fields:[{title:"PO Date",type:"date",name:"poDate",contains:"date",validationProps:"Po Date is required",inpprops:{format:"dd/mm/yyyy"}},{title:"Company",type:"select",name:"companyId",contains:"Select",options:Y},{title:"PO Number",type:"disabled",name:"poNo",contains:"text",validationProps:"Po No is required",inpprops:{format:"dd/mm/yyyy"}},{title:"Supplier",type:"select",name:"supplierId",contains:"Select",options:L},{title:"Delivery Address",type:"textarea",name:"deliveryAddress",contains:"textarea",validationProps:"Delivery Address is required",inpprops:{md:4}},{title:"Payment Terms",type:"select",name:"paymentTerms",validationProps:"Please select Payment Terms",contains:"Select",options:[{value:"Select",label:"Select"},{value:"Advance_Payment",label:"Advance Payment"},{value:"LC",label:"LC"},{value:"CAD",label:"CAD"},{value:"Immediate_After_Delivery",label:"Immediate After Delivery"},{value:"Seven_Days_Credit_From_Dod",label:"7 Days Credit From DOD"},{value:"Fifteen_Days_Credit_From_Dod",label:"15 Days Credit From DOD"},{value:"Thirty_Days_Credit_From_Dod",label:"30 Days Credit From DOD"},{value:"FourtyFive_Days_Credit_From_Dod",label:"45 Days Credit From DOD"},{value:"Ninety_Days_Credit_From_Dod",label:"90 Days Credit From DOD"}]},{title:"Payment Remarks",type:"textarea",name:"paymentRemarks",contains:"textarea",validationProps:"Delivery Address is required",inpprops:{md:4}},{title:"Delivery Terms",type:"select",name:"deliveryTerms",validationProps:"Please select Delivery Terms",contains:"Select",options:[{value:"Select",label:"Select"},{value:"DAP",label:"DAP"},{value:"Ex_works",label:"Ex Works"},{value:"CIF",label:"CIF"},{value:"C_And_F",label:"C&F"},{value:"FOB",label:"FOB"},{value:"DDP",label:"DDP"},{value:"DDU",label:"DDU"}]},{type:"hidden",name:"userId",contains:"hidden",value:Te},{type:"hidden",name:"termsAndConId",contains:"hidden",value:1}]},Me=function(e,t){"update"===e?(C((function(e){return e.map((function(e){return e.materialRequestId===t.materialRequestId?t:e}))})),0==oe?Ie(b.map((function(e){return e.gstAmt})).reduce((function(e,t){return Number(e)+Number(t)}))):le(b.map((function(e){return e.gstAmt})).reduce((function(e,t){return Number(e)+Number(t)}))),we(b.map((function(e){return e.amount})).reduce((function(e,t){return Number(e)+Number(t)}))),Qe((De+Re+oe).toFixed(2))):"SpecsEdit"===e?C((function(e){return e.map((function(e){return e.materialRequestId===t.materialRequestId?t:e}))})):"delete"===e&&(console.log("delete"),console.log(t),C((function(e){return e.filter((function(e){return e.materialRequestId!==t.materialRequestId}))})),console.log(b))};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(F.Z,{size:"xl",show:ve.showForm,onHide:Se,children:[(0,y.jsx)(F.Z.Header,{closeButton:!0,children:(0,y.jsx)(F.Z.Title,{style:{textAlign:"center"},children:"Enter Po Details"})}),(0,y.jsx)(F.Z.Body,{children:ve.selectedForm})]}),(0,y.jsx)(D.Z,{children:(0,y.jsx)(u.Z,{template:Ve,rowwise:3,watchFields:["supplierId","companyId"],validate:function(t,r){var s;r.errors,r.setError,r.clearErrors,console.log("logged"),""!=t[0]&&t[0]?(console.log(t[0]),(s=t[0],(0,o.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loading Products"),e.next=3,c(P.ZP+"/supplier/getById",{supplierId:s,random:Math.random()});case 3:t=e.sent,console.log(t),33!=(null===t||void 0===t?void 0:t.stateId)?(0==oe&&1==re&&(le(De),Ie(0)),ne(!0)):oe>0&&(Ie(oe),le(0));case 6:case"end":return e.stop()}}),e)}))))()):void 0!=t[1]&&Number(t[1])!=g&&(console.log(t[1]),j(Number(t[1])),function(t){return(0,o.Z)((0,a.Z)().mark((function r(){var s;return(0,a.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("loading Products"),r.next=3,c(P.ZP+"/company/getById",{companyId:t,random:Math.random()});case 3:s=r.sent,console.log(s),V((function(t){return(0,n.Z)((0,n.Z)({},B),{},{deliveryAddress:s.companyAddress,poNo:"".concat("PO"===e.poType?"PO":"JO","-").concat(s.prefixName).concat(Z)})}));case 6:case"end":return r.stop()}}),r)})))}(t[1])())},onSubmit:function(t){t.poItems=b,t.roundOff=ce.roundOff,t.notes=ce.notes,t.grossAmt=Re,t.netAmt=Re+De,t.gstAmt=De,t.iGst=oe,t.cGst=De/2,t.sGst=De/2,t.totalGst=De+oe,t.poType=e.poType,console.log(t),e.saveFunction(t)},onCancel:e.onCancel,defaultValues:B,buttonName:"Submit",styles:O,btButtons:(0,y.jsx)(q,{finalSubmit:function(e){de((0,n.Z)((0,n.Z)({},ce),{},{roundOff:e[0],notes:e[1]})),console.log(ce)},gstAmt:De,gross:Re,net:ke,igstAmt:oe,showFormHandler:function(e,t){if("FurnanceForm"==t){Ce(e.requestItems,e);var r={showForm:!0,selectedForm:(0,y.jsx)(A,{handleEditRequests:Pe,matReqs:(0,s.Z)(R),rowData:e,onCancel:Se}),selectedItem:(0,n.Z)({},e)};Ne((0,n.Z)((0,n.Z)({},ve),r))}else if("EditEntry"==t){var a={showForm:!0,selectedForm:(0,y.jsx)(w,{handleEditRequests:Pe,rowData:e,onCancel:Se}),selectedItem:(0,n.Z)({},e)};Ne((0,n.Z)((0,n.Z)({},ve),a))}},hideFormHandler:Se,handleEdit:function(e,t,r){"unitPrice"===e?(console.log(r),r.unitPrice=t,r.amount=t*r.poQty,r.gstAmt=(t*r.poQty*.01*r.gst).toFixed(2),Me("update",r)):"qty"===e?(r.poQty=t,r.amount=r.unitPrice*r.poQty,r.gstAmt=(r.unitPrice*r.poQty*.01*r.gst).toFixed(2),Me("update",r)):Me(e,r)},materials:Ze,terms:X,data:b,savePo:function(e,t){"add"===t?(e.isRequest="No",C((function(t){return[].concat((0,s.Z)(t),[e])})),we(Re+e.amount),re?(le(Number(oe)+Number(e.gstAmt)),Qe(oe+Re)):(Ie(Number(De)+Number(e.gstAmt)),Qe(De+Re))):(console.log((0,n.Z)({},e)),C(b.filter((function(t){return t.materialRequestId!==e.materialRequestId}))))},updateItems:Me})})})]})}}}]);
//# sourceMappingURL=4147.1f120b76.chunk.js.map