"use strict";(self.webpackChunkcosting=self.webpackChunkcosting||[]).push([[305],{17215:function(e,t,r){r.r(t),r.d(t,{default:function(){return X}});var a=r(1413),n=r(74165),s=r(15861),l=r(42982);var i=r(70885),o=r(72791),c=r(60057),u=r(46844),d=(r(78431),{container:"orders_container__0a1bb"}),m=r(79747),p=r(89743),x=r(2677),Z=r(80184),h=function(e,t){return[{title:"Item",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.material.materialName})}},{title:"Req No",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.purchaseRequest.requestNo})}},{title:"Req Date",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.purchaseRequest.requestDate})}},{title:"PRType",align:"c`enter",render:function(e){return(0,Z.jsxs)("span",{children:[" ",e.purchaseRequest.requestType]})}},{title:"User Name",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.purchaseRequest.user.userName})}},{title:"Expected On",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.expectedDate})}},{title:"Aprd Qty",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.materialQty})}},{title:"PO Qty",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.poQty})}},{title:"Department",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.purchaseRequest.department})}},{title:"Description",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.purchaseRequest.description})}}]},f=(r(38595),r(30717)),y=r(61134),v=r(97829),g=r(73728);var j=function(e){var t=(0,o.useState)(),r=(0,i.Z)(t,2),n=r[0],s=(r[1],(0,o.useState)(e.deliveries)),l=(0,i.Z)(s,2),c=(l[0],l[1],(0,y.cI)({defaultValues:(0,a.Z)({},n)})),u=c.register,d=c.handleSubmit,m=c.formState.errors,h=(c.watch,c.setError,c.clearErrors,c.setValue,c.reset);return(0,o.useEffect)((function(){h(e.defaultValues)}),[e.defaultValues]),(0,Z.jsx)(f.Z,{className:v.Z.formcon,children:(0,Z.jsxs)(p.Z,{style:{backgroundColor:"darkgrey",borderRadius:"1em"},children:[(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Material Category"}),(0,Z.jsxs)(f.Z.Select,(0,a.Z)((0,a.Z)({id:"items"},u("quantity",{required:"Items is Required"})),{},{children:[(0,Z.jsx)("option",{value:"Adapter",children:"Raw Materials"}),(0,Z.jsx)("option",{value:"Conector",children:"Office Supplies"}),(0,Z.jsx)("option",{value:"Pins",children:"Electronics"})]})),m.lineNo&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:m.lineNo.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Material Sub-Category"}),(0,Z.jsxs)(f.Z.Select,(0,a.Z)((0,a.Z)({id:"items"},u("quantity",{required:"Items is Required"})),{},{children:[(0,Z.jsx)("option",{value:"Adapter",children:"Adapter"}),(0,Z.jsx)("option",{value:"Conector",children:"Conector"}),(0,Z.jsx)("option",{value:"Pins",children:"Pins"})]})),m.lineNo&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:m.lineNo.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Material Name"}),(0,Z.jsxs)(f.Z.Select,(0,a.Z)((0,a.Z)({id:"items"},u("quantity",{required:"Items is Required"})),{},{children:[(0,Z.jsx)("option",{value:"Adapter",children:"Adapter"}),(0,Z.jsx)("option",{value:"Conector",children:"Conector"}),(0,Z.jsx)("option",{value:"Pins",children:"Pins"})]})),m.lineNo&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:m.lineNo.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:3,children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"quantity",children:"Quantity"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"number",id:"quantity",name:"quantity"},u("quantity",{required:"Quantity is Required"})),{},{min:1,step:1,max:e.maxQty})),m.quantity&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:m.quantity.message})]},"quantity")}),(0,Z.jsxs)(x.Z,{md:3,children:[(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"deliveryDate",children:"Expected Date"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)({type:"date",id:"deliveryDate",name:"deliveryDate"},u("deliveryDate",{required:"Enter Delivery Date"}))),m.deliveryDate&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:m.deliveryDate.message})]},"deliveryDate"),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"hidden",id:"orderId",name:"orderId"},u("orderId")),{},{value:e.orderId?e.orderId:""})),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"hidden",id:"deliveryId",name:"deliveryId"},u("deliveryId")),{},{value:e.delivery?e.delivery.deliveryId:""}))]}),(0,Z.jsxs)(x.Z,{md:1,children:[" ",(0,Z.jsx)("a",{children:(0,Z.jsx)(g.qVg,{size:38,className:v.Z.btnextra,onClick:d((function(t){e.saveDeliveries(t),h()})),hover:!0})})]})]})})},N=r(23118),b=[{id:1,Lineno:"Connecter",Date:"15/10/2022",Quantity:"25",price:"40",totalPrice:"1000"},{id:2,Lineno:"Tables",Date:"15/11/2022",Quantity:"20",price:"52",totalPrice:"1040"},{id:3,Lineno:"Stationaries",Date:"15/12/2022",Quantity:"2",price:"400",totalPrice:"800"},{id:4,Lineno:"Pins",Date:"15/01/2023",Quantity:"5",price:"300",totalPrice:"1500"},{id:5,Lineno:"Adapeter",Date:"15/02/2023",Quantity:"7",price:"400",totalPrice:"2800"}],S=r(23853),P=function(e,t,r){return[{title:"Material Name",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.Lineno})}},{title:"Quantity",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.Quantity})}},{title:"Expected Date",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.Date})}},{title:"Remove",align:"center",render:function(t){return(0,Z.jsx)(S.Ybf,{style:{cursor:"pointer"},onClick:e(t)})}}]};var q=function(e){var t=e.data?e.data:[],r=(0,o.useState)(t),a=(0,i.Z)(r,2),n=a[0],s=(a[1],(0,o.useState)({})),l=(0,i.Z)(s,2),c=l[0],u=(l[1],(0,o.useState)(n.length>0?e.maxQty-n.map((function(e){return e.quantity})).reduce((function(e,t){return e+t})):e.maxQty)),d=(0,i.Z)(u,2),m=d[0],p=d[1];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(j,{saveDeliveries:function(t){p(m-t.quantity),t.revisedDate=t.deliveryDate,e.onDeliveryUpdate(t,"add")},defaultValues:c,maxQty:m}),(0,Z.jsx)(N.Z,{data:b,cols:P((function(t){return function(){p(m+t.quantity),e.onDeliveryUpdate(t,"deleted")}}),"",[6,5])})]})},C=r(99355),D=r(21229);var I=function(e){var t=(0,D.ZP)({data:[]}),r=t.get,u=(t.post,t.response),d=(t.loading,t.error,(0,o.useState)(e.selectedItem.deliveries?e.selectedItem.deliveries:[])),m=(0,i.Z)(d,2),p=m[0],x=m[1],h=(0,o.useState)(e.selectedItem?e.selectedItem.quantity:1),f=(0,i.Z)(h,2),y=f[0],v=f[1],g=(0,o.useState)([{value:"",label:"Select"}]),j=(0,i.Z)(g,2),N=j[0],b=j[1],S=(0,o.useCallback)((0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(C.ZP+"/product/loadOptions");case 2:t=e.sent,b([].concat((0,l.Z)(N),(0,l.Z)(t)));case 4:case"end":return e.stop()}}),e)}))),[r,u]);return(0,o.useEffect)((function(){S()}),[]),(0,Z.jsx)(c.Z,{template:{heading:"Purchase Request Entry",fields:[{title:"Req Number",type:"text",name:"orderNo",contains:"text",inpprops:{}},{title:"Req Date",type:"date",name:"OrderDate",contains:"date",validationProps:"Internal Part No is required",inpprops:{format:"dd/mm/yyyy"}},{title:"Depatment",type:"select",name:"Department",validationProps:"Please select Shift",contains:"Select",options:[{value:"",label:"Select"},{value:"Shift_A",label:"Administration"},{value:"Shift_B",label:"Production"},{value:"Shift_C",label:"Quality"},{value:"Shift_C",label:"Stores"}]},{title:"Purpose",type:"textarea",name:"remarks",contains:"textarea",inpprops:{maxlength:128,md:4}}]},rowwise:3,watchFields:["quantity"],validate:function(e,t){t.errors,t.setError,t.clearErrors,e[0]>0&&(console.log(e[0]),v(e[0]))},onSubmit:function(t){t.deliveries=p,e.saveFunction(t),console.log(t)},onCancel:e.onCancel,buttonName:"Submit",defaultValues:e.selectedItem,btButtons:(0,Z.jsx)(q,{data:p,onDeliveryUpdate:function(e,t){"add"===t?x((function(t){return[].concat((0,l.Z)(t),[e])})):(console.log((0,a.Z)({},e)),x(p.filter((function(t){return t.lineNo!==e.lineNo}))))},maxQty:y})})},F=r(59434),A=r(34476),R=r(4349);function Q(e,t){var r=t.errors,a=t.setError,n=t.clearErrors;"Admin"===e.firstname?r.firstname||a("firstname",{type:"manual",message:"You cannot use this first name"}):r.firstname&&"manual"===r.firstname.type&&n("firstname")}var w=function(e){return(0,Z.jsx)(c.Z,{template:{heading:"Update Status",fields:[{title:"Material Name",type:"text",name:"mat1",contains:"text",validation:"Quantity is Required",inpprops:{min:1,step:1}},{title:"Quantity",type:"number",name:"Qty1",contains:"number",validation:"Quantity is Required",inpprops:{min:1,step:1}},{title:"PO Status",type:"select",name:"joStatus1",contains:"Select",validationProps:"Please Select Job Order status",options:[{value:"",label:"Select"},{value:"Approved",label:"Approve"},{value:"Rejected",label:"Reject"}]},{title:"Material Name",type:"text",name:"mat2",contains:"text",validation:"Quantity is Required",inpprops:{min:1,step:1}},{title:"Quantity",type:"number",name:"Qty2",contains:"number",validation:"Quantity is Required",inpprops:{min:1,step:1}},{title:"PO Status",type:"select",name:"joStatus1",contains:"Select",validationProps:"Please Select Job Order status",options:[{value:"",label:"Select"},{value:"Approved",label:"Approve"},{value:"Rejected",label:"Reject"}]},{title:"Material Name",type:"text",name:"mat3",contains:"text",validation:"Quantity is Required",inpprops:{min:1,step:1}},{title:"Quantity",type:"number",name:"Qty3",contains:"number",validation:"Quantity is Required",inpprops:{min:1,step:1}},{title:"PO Status",type:"select",name:"joStatus1",contains:"Select",validationProps:"Please Select Job Order status",options:[{value:"",label:"Select"},{value:"Approved",label:"Approve"},{value:"Rejected",label:"Reject"}]}]},rowwise:3,validate:Q,onSubmit:function(t){console.log(t),e.saveFunction(t)},onCancel:e.onCancel,buttonName:"Save",defaultValues:{mat1:"material1",mat2:"material2",mat3:"material3",Qty1:"132",Qty2:"12",Qty3:"1"}})},M=r(43360),G=r(21216);var E=function(e){var t=(0,F.I0)(),r=(0,o.useState)({}),n=(0,i.Z)(r,2),s=n[0],l=n[1],c=(0,F.v9)((function(e){return[e.alertProps.showAlert,e.alertProps.alertMessage,e.alertProps.alertVariant]})),u=(0,i.Z)(c,3),d=u[0],m=(u[1],u[2],(0,o.useState)()),h=(0,i.Z)(m,2),j=h[0],N=(h[1],(0,y.cI)({defaultValues:(0,a.Z)({},j)})),b=N.register,S=N.handleSubmit,P=N.formState.errors,q=(N.watch,N.setError,N.clearErrors,N.setValue,N.reset);return(0,o.useEffect)((function(){q(e.defaultValues)}),[e.defaultValues]),(0,Z.jsx)(f.Z,{className:v.Z.formcon,children:(0,Z.jsxs)(p.Z,{style:{backgroundColor:G.Z.colors.dgc,borderRadius:"1em"},children:[(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Material Category"}),(0,Z.jsxs)(f.Z.Select,(0,a.Z)((0,a.Z)({type:"text",id:"category",name:"category"},b("category")),{},{onChange:function(t){e.loadCatMaterials(t.target.value)},className:v.Z.formBorder,children:[(0,Z.jsx)("option",{value:"",children:"Select"}),(0,Z.jsx)("option",{value:"Raw_Materials",children:"Raw Materials"}),(0,Z.jsx)("option",{value:"Office_Supplies",children:"Office Supplies"}),(0,Z.jsx)("option",{value:"Electronics",children:"Electronics"}),(0,Z.jsx)("option",{value:"Consumables",children:"Consumables"})]})),P.materialId&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:P.materialId.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Material"}),(0,Z.jsx)(f.Z.Select,(0,a.Z)((0,a.Z)({type:"text",id:"materialId",name:"materialId"},b("materialId",{required:"Material is Required"})),{},{onChange:function(t){e.loadMaterials(t.target.value)},className:v.Z.formBorder,children:e.materials.map((function(e,t){var r=e.value,a=e.label;return(0,Z.jsx)("option",{value:r,children:a})}))})),P.materialId&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:P.materialId.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Uom"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"text",id:"uom",name:"uom",defaultValue:e.loadedMaterial.uom,disabled:!0,readOnly:!0},b("uom")),{},{className:v.Z.formBorder,style:{backgroundColor:"transparent"}})),P.uome&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:P.uom.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Unit Price"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"text",id:"unitPrice",name:"unitPrice"},b("unitPrice")),{},{defaultValue:e.loadedMaterial.lastPurchasePrice,className:v.Z.formBorder})),P.unitPrice&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:P.unitPrice.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"amount",children:"HSN/SAC Code"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"text",id:"hsnCode",name:"hsnCode"},b("hsnCode")),{},{className:v.Z.formBorder})),P.hsnCode&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:P.hsnCode.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"GST Percentage"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"text",id:"gst",name:"gst"},b("gst")),{},{defaultValue:e.loadedMaterial.gst,className:v.Z.formBorder})),P.gst&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:P.gst.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Cost Center"}),(0,Z.jsxs)(f.Z.Select,(0,a.Z)((0,a.Z)({type:"text",id:"costCenter",name:"costCenter"},b("costCenter",{required:"Line No is Required"})),{},{className:v.Z.formBorder,children:[(0,Z.jsx)("option",{value:"0",children:"Select"}),(0,Z.jsx)("option",{value:"1",children:"Cost Center 1"}),(0,Z.jsx)("option",{value:"2",children:"Cost Center 2"}),(0,Z.jsx)("option",{value:"3",children:"Cost Center 3"})]})),P.costCenter&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:P.costCenter.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"quantity",children:"Quantity"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"number",id:"quantity",name:"quantity"},b("quantity",{required:"Quantity is Required"})),{},{min:1,step:1,max:e.maxQty,className:v.Z.formBorder})),P.quantity&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:P.quantity.message})]},"quantity")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"quantity",children:"Due Date"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"date",id:"dueDate",name:"dueDate"},b("dueDate")),{},{min:1,step:1,max:e.maxQty,className:v.Z.formBorder})),P.dueDate&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:P.dueDate.message})]},"quantity")}),(0,Z.jsxs)(x.Z,{md:1,children:[" ",(0,Z.jsx)("a",{children:(0,Z.jsx)(g.qVg,{size:38,className:v.Z.btnextra,onClick:S((function(r){if(0!=e.loadedMaterial.materialId){var a=e.data.find((function(t){return t.material.materialId===e.loadedMaterial.materialId}));l(a)}else l({});var n,i;null!==s&&void 0!==s&&s.material.materialId?(n="Cannot Add Same Material Please Edit Quantity",i="success",t(R.I.showAlertHandler({showAlert:!d,alertMessage:n,alertVariant:i})),q()):(""===r.unitPrice&&(r.unitPrice=e.loadedMaterial.lastPurchasePrice),r.gst=e.loadedMaterial.gst,r.material=e.loadedMaterial,r.materialRequestId=(1e4*Math.random()).toFixed(0),r.requests=1,r.isRequest="No",r.requestItems=[],r.poQty=r.quantity,r.specs="",r.amount=r.unitPrice*r.quantity,r.gstAmt=(r.unitPrice*r.poQty*.01*r.gst).toFixed(2),e.savePo(r,"add"),q())})),hover:!0})})]})]})})},O=function(e,t,r){return[{title:"Item Name",align:"center",render:function(e){return(0,Z.jsx)(Z.Fragment,{children:""===e.specs?(0,Z.jsx)("span",{children:e.itemName}):(0,Z.jsxs)("span",{children:[e.itemName,"(",e.specs,")"]})})}},{title:"Specs",align:"center",render:function(t){return(0,Z.jsx)(S.vPQ,{style:{cursor:"pointer"},onClick:e(t,"EditEntry")})}},{title:"Due Date",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.dueDate})}},{title:"Unit Price",align:"center",render:function(e){var r="unitPrice".concat(e.purchaseRequestId);return(0,Z.jsx)(f.Z.Group,{children:(0,Z.jsx)(f.Z.Control,{type:"text",id:r,name:r,defaultValue:e.unitPrice,onBlur:function(r){return t("unitPrice",r.target.value,e)}})},"producedQty")}},{title:"Quantity",align:"center",render:function(r){var a="qty".concat(r.purchaseRequestId);return(0,Z.jsx)("span",{children:1==r.requests?(0,Z.jsx)(f.Z.Group,{children:(0,Z.jsx)(f.Z.Control,{type:"text",id:a,name:a,defaultValue:r.poQty,onBlur:function(e){return t("qty",e.target.value,r)}})},"producedQty"):(0,Z.jsx)("span",{style:{cursor:"pointer",color:"blue"},onClick:e(r,"FurnanceForm"),children:r.poQty})})}},{title:"Uom",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.material.uom})}},{title:"Gst Perc",align:"center",render:function(e){"gst".concat(e.purchaseRequestId);return(0,Z.jsx)("span",{children:e.gst})}},{title:"Gst",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.gstAmt})}},{title:"Amount",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.amount})}},{title:"Remove",align:"center",render:function(t){return(0,Z.jsx)(S.Ybf,{style:{cursor:"pointer"},onClick:e(t,"delete")})}}]};var k=function(e){var t=(0,o.useState)(),r=(0,i.Z)(t,2),n=r[0],s=(r[1],(0,y.cI)({defaultValues:(0,a.Z)({},n)})),c=s.register,u=(s.handleSubmit,s.formState.errors),d=s.watch,m=(s.setError,s.clearErrors,s.setValue,s.reset),h=d(["roundOff","notes"]),g=(0,o.useState)({roundOff:"0",notes:""}),j=(0,i.Z)(g,2);return j[0],j[1],(0,o.useEffect)((function(){e.saveValues(h)}),(0,l.Z)(h)),(0,o.useEffect)((function(){m(e.defaultValues)}),[e.defaultValues]),(0,Z.jsx)(f.Z,{className:v.Z.formcon,children:(0,Z.jsxs)(p.Z,{style:{backgroundColor:G.Z.colors.dg,borderRadius:"1em"},children:[(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"CGst Amount"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"textarea",id:"cGst",name:"cGst",defaultValue:(e.gstAmt/2).toFixed(2)},c("cGst")),{},{className:v.Z.formBorder})),u.cGst&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:u.cGst.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"SGst Amount"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"textarea",id:"sGst",name:"sGst",defaultValue:(e.gstAmt/2).toFixed(2)},c("sGst")),{},{className:v.Z.formBorder})),u.sGst&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:u.sGst.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"IGst Amount"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"textarea",id:"iGst",name:"iGst",defaultValue:e.igstAmt.toFixed(2)},c("iGst")),{},{className:v.Z.formBorder})),u.iGst&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:u.iGst.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Total Gst"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"textarea",id:"totalGst",name:"totalGst",defaultValue:Number(e.gstAmt+e.igstAmt).toFixed(2)},c("totalGst")),{},{className:v.Z.formBorder})),u.totalGst&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:u.totalGst.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Gross Amount"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"textarea",id:"grossAmt",name:"grossAmt",defaultValue:e.gross},c("grossAmt")),{},{className:v.Z.formBorder})),u.grossAmt&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:u.grossAmt.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Net Amount"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"textarea",id:"netAmt",name:"netAmt",defaultValue:e.gstAmt+e.gross},c("netAmt")),{},{className:v.Z.formBorder})),u.netAmt&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:u.netAmt.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Round-OFF Amt"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({type:"textarea",id:"roundOff",name:"roundOff",defaultValue:0},c("roundOff")),{},{className:v.Z.formBorder})),u.roundOff&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:u.roundOff.message})]},"lineNo")}),(0,Z.jsx)(x.Z,{md:{span:3},children:(0,Z.jsxs)(f.Z.Group,{children:[(0,Z.jsx)(f.Z.Label,{htmlFor:"lineNo",children:"Notes"}),(0,Z.jsx)(f.Z.Control,(0,a.Z)((0,a.Z)({as:"textarea",id:"notes",name:"notes",defaultValue:""},c("notes")),{},{className:v.Z.formBorder})),u.notes&&(0,Z.jsx)(f.Z.Text,{className:"text-danger",children:u.notes.message})]},"lineNo")})]})})};var T=function(e){e.data&&e.data;var t=(0,o.useState)({}),r=(0,i.Z)(t,2),c=r[0],u=(r[1],(0,o.useState)(e.data?e.data:[])),d=(0,i.Z)(u,2),m=(d[0],d[1],(0,o.useState)()),p=(0,i.Z)(m,2),x=(p[0],p[1],(0,o.useState)(e.materials)),h=(0,i.Z)(x,2),f=h[0],y=h[1],v=(0,o.useState)({materialName:"",uom:""}),g=(0,i.Z)(v,2),j=g[0],b=g[1],S=(0,D.ZP)({data:[]}),P=(S.get,S.post),q=S.response,I=(S.loading,S.error,function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,P(C.ZP+"/material/getById",{materialId:t});case 3:r=e.sent,q.ok?b((function(e){return(0,a.Z)({},r)})):b("Not Available"),console.log(j);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),F=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(C.ZP+"/material/loadOptionsByCategory",{category:t});case 2:r=e.sent,q.ok&&y([{value:"",label:"Select"}].concat((0,l.Z)(r)));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,Z.jsxs)("div",{style:{padding:"0 1.5rem"},children:[(0,Z.jsx)(E,{loadMaterials:I,loadCatMaterials:F,loadedMaterial:j,materials:f,defaultValues:c,savePo:e.savePo,data:e.data}),(0,Z.jsx)(N.Z,{data:e.data,cols:O((function(t,r){return function(){"delete"===r?e.handleEdit(r,"",t):e.showFormHandler(t,r)}}),e.handleEdit)}),(0,Z.jsx)(k,{gstAmt:e.gstAmt,gross:e.gross,net:e.net,igstAmt:e.igstAmt,terms:e.terms,saveValues:e.finalSubmit})]})},V=r(95316),_=function(e,t){return[{title:"Item Name",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.material.materialName})}},{title:"Request No",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.purchaseRequest.requestNo})}},{title:"Department",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.purchaseRequest.department})}},{title:"Request Person",align:"center",render:function(e){return(0,Z.jsx)("span",{children:e.purchaseRequest.user.userName})}},{title:"Quantity",align:"center",render:function(t){var r="qty".concat(t.materialQty);return(0,Z.jsx)("span",{children:(0,Z.jsx)(f.Z.Group,{children:(0,Z.jsx)(f.Z.Control,{type:"text",id:r,name:r,defaultValue:t.poQty,onBlur:function(r){return e(r.target.value,t)}})},"producedQty")})}},{title:"Uom",align:"center",render:function(e){"gst".concat(e.purchaseRequestId);return(0,Z.jsx)("span",{children:e.material.uom})}},{title:"Gst Perc",align:"center",render:function(e){"gst".concat(e.purchaseRequestId);return(0,Z.jsx)("span",{children:e.material.gst})}}]},B=function(e){console.log(e.matReqs);var t=(0,o.useState)(),r=(0,i.Z)(t,2);r[0],r[1];return(0,Z.jsx)(m.Z,{children:(0,Z.jsx)(N.Z,{data:e.matReqs,cols:_((function(t,r){e.handleEditRequests("QuantityEdit",t,r,e.rowData)}),e.isDefault)})})},L=r(2144);function H(e,t){t.errors,t.setError,t.clearErrors;e[0]>0&&console.log(e[0])}var U=function(e){return(0,Z.jsx)(L.Z,{children:(0,Z.jsx)(c.Z,{template:{heading:"Edit Specifications",fields:[{title:"Edit Specs",type:"text",name:"specs",contains:"text",inpprops:{}}]},rowwise:2,validate:H,onSubmit:function(t){e.handleEditRequests("SpecsEdit",t.specs,"",e.rowData)},onCancel:e.onCancel,defaultValues:e.rowData,buttonName:"Save"})})},Y=r(50654),z={upper:{padding:"0"},upperRow:{margin:".5rem .5rem 0 .5rem",padding:"0 1rem 0 1rem",backgroundColor:G.Z.colors.dg,borderRadius:"1rem"},uppertitle:{borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:G.Z.colors.ttle}};var J=function(e){var t=(0,D.ZP)({data:[]}),r=t.get,u=t.post,d=t.response,m=(t.loading,t.error,(0,o.useState)(e.reqNo)),p=(0,i.Z)(m,2),x=p[0],h=(p[1],(0,o.useState)(0)),f=(0,i.Z)(h,2),y=f[0],v=f[1],g=(0,o.useState)(e.selectedItems?e.selectedItems:[]),j=(0,i.Z)(g,2),N=j[0],b=j[1],S=(0,o.useState)([]),P=(0,i.Z)(S,2),q=P[0],I=P[1],F=(0,o.useState)(e.selected?e.selected:{poNo:x}),A=(0,i.Z)(F,2),R=A[0],Q=A[1],w=(0,o.useState)([{value:"",label:"Select"}]),M=(0,i.Z)(w,2),G=(M[0],M[1],(0,o.useState)([{value:"",label:"Select"}])),E=(0,i.Z)(G,2),O=E[0],k=E[1],_=(0,o.useState)(!1),L=(0,i.Z)(_,2),H=L[0],J=L[1],W=(0,o.useState)(0),K=(0,i.Z)(W,2),X=K[0],$=K[1],ee=(0,o.useState)({termsAndConId:"",roundOff:0,notes:""}),te=(0,i.Z)(ee,2),re=te[0],ae=te[1],ne=(0,o.useState)([{value:"",label:"Select"}]),se=(0,i.Z)(ne,2),le=se[0],ie=se[1],oe=(0,o.useState)({showForm:!1,selectedForm:(0,Z.jsx)(Z.Fragment,{}),selectedItem:{id:0,productName:"",cusName:"",part:"",quantity:"",cost:""}}),ce=(0,i.Z)(oe,2),ue=ce[0],de=ce[1],me=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t,r){var a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(C.ZP+"/matrialPrItems/multipleRequests",{ids:t});case 2:if(a=e.sent,d.ok){for(s=0;s<a.length;s++)a[s].poQty=r.requestQty[s];I((function(e){return(0,l.Z)(a)})),I((function(e){return console.log(e),e})),console.log(q)}case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),pe=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t,r,a,s){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"QuantityEdit"===t?(a.poQty=r,console.log(q),I((function(e){return e.map((function(e){return e.materialRequestId===a.materialRequestId?a:e}))})),console.log(q),s.requestQty[s.requestItems.findIndex((function(e){return e===a.materialRequestId}))]=r,s.poQty=s.requestQty.map((function(e){return e})).reduce((function(e,t){return Number(e)+Number(t)})),s.amount=s.unitPrice*s.poQty,s.gstAmt=(s.unitPrice*s.poQty*.01*s.gst).toFixed(2),Fe("update",s)):"SpecsEdit"===t&&(s.specs=r,Fe("SpecsEdit",s));case 1:case"end":return e.stop()}}),e)})));return function(t,r,a,n){return e.apply(this,arguments)}}(),xe=function(){de((0,a.Z)((0,a.Z)({},ue),{},{showForm:!1,selectedForm:"",selectedItem:(0,a.Z)((0,a.Z)({},ue.selectedItem),{id:0,productName:"",cusName:"",part:"",quantity:"",cost:""})}))},Ze=(0,o.useState)(N.length>0?N.map((function(e){return e.gstAmt})).reduce((function(e,t){return Number(e)+Number(t)})):0),he=(0,i.Z)(Ze,2),fe=he[0],ye=he[1],ve=(0,o.useState)(N.length>0?N.map((function(e){return e.amount})).reduce((function(e,t){return Number(e)+Number(t)})):0),ge=(0,i.Z)(ve,2),je=ge[0],Ne=ge[1],be=(0,o.useState)(fe+je),Se=(0,i.Z)(be,2),Pe=Se[0],qe=Se[1],Ce=(0,o.useContext)(Y.Z).userId,De=(0,o.useCallback)((0,s.Z)((0,n.Z)().mark((function e(){var t,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(C.ZP+"/material/loadOptions");case 2:return t=e.sent,e.next=5,r(C.ZP+"/terms/loadOptions");case 5:a=e.sent,ie([].concat((0,l.Z)(le),(0,l.Z)(t))),k([].concat((0,l.Z)(O),(0,l.Z)(a)));case 8:case"end":return e.stop()}}),e)}))),[r,d]);(0,o.useEffect)((function(){De()}),[]);var Ie={heading:"New Purchase Order",fields:[{title:"PO Date",type:"date",name:"poDate",contains:"date",validationProps:"Po Date is required",inpprops:{format:"dd/mm/yyyy"}},{title:"Company",type:"select",name:"companyId",contains:"Select",options:e.company},{title:"PO Number",type:"disabled",name:"poNo",contains:"text",validationProps:"Po No is required",inpprops:{format:"dd/mm/yyyy"}},{title:"Supplier",type:"select",name:"supplierId",contains:"Select",options:e.suppliers},{title:"Delivery Address",type:"textarea",name:"deliveryAddress",contains:"textarea",validationProps:"Delivery Address is required",inpprops:{md:4}},{title:"Payment Terms",type:"select",name:"paymentTerms",validationProps:"Please select Payment Terms",contains:"Select",options:[{value:"Select",label:"Select"},{value:"Advance_Payment",label:"Advance Payment"},{value:"LC",label:"LC"},{value:"CAD",label:"CAD"},{value:"Immediate_After_Delivery",label:"Immediate After Delivery"},{value:"Seven_Days_Credit_From_Dod",label:"7 Days Credit From DOD"},{value:"Fifteen_Days_Credit_From_Dod",label:"15 Days Credit From DOD"},{value:"Thirty_Days_Credit_From_Dod",label:"30 Days Credit From DOD"},{value:"FourtyFive_Days_Credit_From_Dod",label:"45 Days Credit From DOD"},{value:"Ninety_Days_Credit_From_Dod",label:"90 Days Credit From DOD"}]},{title:"Payment Remarks",type:"textarea",name:"paymentRemarks",contains:"textarea",validationProps:"Delivery Address is required",inpprops:{md:4}},{title:"Delivery Terms",type:"select",name:"deliveryTerms",validationProps:"Please select Delivery Terms",contains:"Select",options:[{value:"Select",label:"Select"},{value:"DAP",label:"DAP"},{value:"Ex_works",label:"Ex Works"},{value:"CIF",label:"CIF"},{value:"C_And_F",label:"C&F"},{value:"FOB",label:"FOB"},{value:"DDP",label:"DDP"},{value:"DDU",label:"DDU"}]},{type:"hidden",name:"userId",contains:"hidden",value:Ce},{type:"hidden",name:"termsAndConId",contains:"hidden",value:1}]},Fe=function(e,t){"update"===e?(b((function(e){return e.map((function(e){return e.materialRequestId===t.materialRequestId?t:e}))})),0==X?ye(N.map((function(e){return e.gstAmt})).reduce((function(e,t){return Number(e)+Number(t)}))):$(N.map((function(e){return e.gstAmt})).reduce((function(e,t){return Number(e)+Number(t)}))),Ne(N.map((function(e){return e.amount})).reduce((function(e,t){return Number(e)+Number(t)}))),qe((fe+je+X).toFixed(2))):"SpecsEdit"===e?b((function(e){return e.map((function(e){return e.materialRequestId===t.materialRequestId?t:e}))})):"delete"===e&&(console.log("delete"),console.log(t),b((function(e){return e.filter((function(e){return e.materialRequestId!==t.materialRequestId}))})),console.log(N))};return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(V.Z,{size:"xl",show:ue.showForm,onHide:xe,children:[(0,Z.jsx)(V.Z.Header,{closeButton:!0,children:(0,Z.jsx)(V.Z.Title,{style:{textAlign:"center"},children:"Enter Po Details"})}),(0,Z.jsx)(V.Z.Body,{children:ue.selectedForm})]}),(0,Z.jsx)(c.Z,{template:Ie,rowwise:3,watchFields:["supplierId","companyId"],validate:function(e,t){var r;t.errors,t.setError,t.clearErrors,console.log("logged"),""!=e[0]&&e[0]?(console.log(e[0]),(r=e[0],(0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loading Products"),e.next=3,u(C.ZP+"/supplier/getById",{supplierId:r,random:Math.random()});case 3:t=e.sent,console.log(t),33!=(null===t||void 0===t?void 0:t.stateId)?(0==X&&1==H&&($(fe),ye(0)),J(!0)):X>0&&(ye(X),$(0));case 6:case"end":return e.stop()}}),e)}))))()):void 0!=e[1]&&Number(e[1])!=y&&(console.log(e[1]),v(Number(e[1])),function(e){return(0,s.Z)((0,n.Z)().mark((function t(){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("loading Products"),t.next=3,u(C.ZP+"/company/getById",{companyId:e,random:Math.random()});case 3:r=t.sent,console.log(r),Q((function(e){return(0,a.Z)((0,a.Z)({},R),{},{deliveryAddress:r.companyAddress,poNo:"PO-".concat(r.prefixName).concat(x)})}));case 6:case"end":return t.stop()}}),t)})))}(e[1])())},onSubmit:function(t){t.poItems=N,t.roundOff=re.roundOff,t.notes=re.notes,t.grossAmt=je,t.netAmt=Pe,t.gstAmt=fe,t.iGst=X,t.cGst=fe/2,t.sGst=fe/2,t.totalGst=fe+X,console.log(t),e.saveFunction(t)},onCancel:e.onCancel,defaultValues:R,buttonName:"Submit",styles:z,btButtons:(0,Z.jsx)(T,{finalSubmit:function(e){ae((0,a.Z)((0,a.Z)({},re),{},{roundOff:e[0],notes:e[1]})),console.log(re)},gstAmt:fe,gross:je,net:Pe,igstAmt:X,showFormHandler:function(e,t){if("FurnanceForm"==t){me(e.requestItems,e);var r={showForm:!0,selectedForm:(0,Z.jsx)(B,{handleEditRequests:pe,matReqs:(0,l.Z)(q),rowData:e,onCancel:xe}),selectedItem:(0,a.Z)({},e)};de((0,a.Z)((0,a.Z)({},ue),r))}else if("EditEntry"==t){var n={showForm:!0,selectedForm:(0,Z.jsx)(U,{handleEditRequests:pe,rowData:e,onCancel:xe}),selectedItem:(0,a.Z)({},e)};de((0,a.Z)((0,a.Z)({},ue),n))}},hideFormHandler:xe,handleEdit:function(e,t,r){"unitPrice"===e?(console.log(r),r.unitPrice=t,r.amount=t*r.poQty,r.gstAmt=(t*r.poQty*.01*r.gst).toFixed(2),Fe("update",r)):"qty"===e?(r.poQty=t,r.amount=r.unitPrice*r.poQty,r.gstAmt=(r.unitPrice*r.poQty*.01*r.gst).toFixed(2),Fe("update",r)):Fe(e,r)},materials:le,terms:O,data:N,savePo:function(e,t){"add"===t?(e.isRequest="No",b((function(t){return[].concat((0,l.Z)(t),[e])})),Ne(je+e.amount),H?($(Number(X)+Number(e.gstAmt)),qe(X+je)):(ye(Number(fe)+Number(e.gstAmt)),qe(fe+je))):(console.log((0,a.Z)({},e)),b(N.filter((function(t){return t.materialRequestId!==e.materialRequestId}))))},updateItems:Fe})})]})},W=r(22496),K={fields:[{title:"From Date",type:"date",name:"fromDate",contains:"date",inpprops:{format:"dd/mm/yy"}},{title:"To Date",type:"date",name:"toDate",contains:"date",inpprops:{format:"dd/mm/yy"}},{title:"Depatment",type:"select",name:"department",validationProps:"Please select Shift",contains:"Select",options:[{value:"Select",label:"Select"},{value:"Administration",label:"Administration"},{value:"Production",label:"Production"},{value:"Quality",label:"Quality"},{value:"Stores",label:"Stores"}]},{title:"Request Type",type:"select",name:"requestType",contains:"Select",options:[{value:"Select",label:"Select"},{value:"Raw_Materials",label:"Materials"},{value:"Service",label:"Service"}]}]};var X=function(e){var t=(0,o.useState)([]),r=(0,i.Z)(t,2),f=r[0],y=r[1],v=(0,D.ZP)({data:[]}),g=v.get,j=v.post,b=v.response,S=(v.loading,v.error,(0,o.useState)([])),P=(0,i.Z)(S,2),q=P[0],Q=P[1],G=(0,o.useState)(Math.random()),E=(0,i.Z)(G,2),O=E[0],k=(E[1],(0,o.useState)(0)),T=(0,i.Z)(k,2),V=(T[0],T[1],(0,o.useState)([{value:"",label:"Select"}])),_=(0,i.Z)(V,2),B=_[0],L=_[1],H=(0,o.useState)([]),U=(0,i.Z)(H,2),Y=(U[0],U[1],(0,o.useState)(0)),z=(0,i.Z)(Y,2),X=z[0],ee=z[1],te=(0,o.useState)([{value:"",label:"Select"}]),re=(0,i.Z)(te,2),ae=re[0],ne=re[1],se=(0,o.useState)("PO"),le=(0,i.Z)(se,2),ie=le[0],oe=le[1],ce=(0,F.v9)((function(e){return[e.alertProps.showAlert,e.alertProps.alertMessage,e.alertProps.alertVariant]})),ue=(0,i.Z)(ce,3),de=ue[0],me=(ue[1],ue[2],(0,F.v9)((function(e){return[e.modalProps.showModal,e.modalProps.selectedForm,e.modalProps.selectedData]}))),pe=(0,i.Z)(me,3),xe=(pe[0],pe[1],pe[2]),Ze=(0,F.I0)(),he=function(e,t){Ze(R.I.showAlertHandler({showAlert:!de,alertMessage:e,alertVariant:t}))},fe=(0,o.useCallback)((0,s.Z)((0,n.Z)().mark((function e(){var t,r,a,s,i,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(C.ZP+"/supplier/loadOptions");case 2:return t=e.sent,e.next=5,j(C.ZP+"/poMaster/loadReqNo",{random:Math.random()});case 5:return r=e.sent,e.next=8,g(C.ZP+"/company/loadOptions");case 8:return a=e.sent,s=(new Date).getFullYear()-2e3,i=(new Date).getMonth()+1,e.next=13,j(C.ZP+"/matrialPrItems/prItemsForPo",{id:1,random:Math.random()});case 13:o=e.sent,b.ok&&y(o),L([].concat((0,l.Z)(B),(0,l.Z)(t))),ne([].concat((0,l.Z)(ae),(0,l.Z)(a))),ee(i>4?"".concat(s,"/").concat(s+1,"-000").concat(Number(r)+1):"".concat(s-1,"/").concat(s,"-000").concat(Number(r)+1));case 18:case"end":return e.stop()}}),e)}))),[g,b,O]);(0,o.useEffect)((function(){fe()}),[fe]);var ye=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("PO"==ie?C.ZP+"/poMaster/create":C.ZP+"/poMaster/createServicePo",t);case 2:e.sent,b.ok?t.poId?(fe(),Ze(A.n.hideModalHandler()),he("Product Updated Successfully","success")):(fe(),Ze(A.n.hideModalHandler()),he("Purchase Order Created Succesfully","success")):(Ze(A.n.hideModalHandler()),he("Product Details Failed To Save","danger"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(e,t){"update"==t&&(console.log("updated from selected"),Q(q.map((function(t){return t.purchaseRequestId===e.purchaseRequestId?e:t}))))},ge=function(e,t){return function(){"productForm"==t?Ze(A.n.showModalHandler({selectedData:(0,a.Z)({},e),selectedForm:(0,Z.jsx)(I,{onCancel:function(){return Ze(A.n.hideModalHandler())},selectedItem:xe,saveFunction:ye}),showModal:!0})):"edit"===t?(console.log((0,a.Z)({},e)),Ze(A.n.showModalHandler({selectedData:(0,a.Z)({},e),selectedForm:(0,Z.jsx)(I,{onCancel:function(){return Ze(A.n.hideModalHandler())},selectedItem:e,saveFunction:ye}),showModal:!0}))):"approvalForm"==t?Ze(A.n.showModalHandler({selectedData:(0,a.Z)({},e),selectedForm:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(w,{selected:e,saveFunction:ye,onCancel:function(){return Ze(A.n.hideModalHandler())},loadState:O})}),showModal:!0})):"generatePo"==t&&Ze(A.n.showModalHandler({selectedData:(0,a.Z)({},e),selectedForm:(0,Z.jsx)(Z.Fragment,{children:"PO"==ie?(0,Z.jsx)(J,{suppliers:B,company:ae,selectedItems:q,saveFunction:ye,updateItems:ve,onCancel:function(){return Ze(A.n.hideModalHandler())},loadState:O,reqNo:X}):(0,Z.jsx)(W.Z,{suppliers:B,company:ae,selectedItems:q,saveFunction:ye,updateItems:ve,onCancel:function(){return Ze(A.n.hideModalHandler())},loadState:O,reqNo:X})}),showModal:!0}))}},je=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/matrialPrItems/searchPrItems",console.log(r),e.next=4,j(C.ZP+r,t);case 4:a=e.sent,console.log(a),a.length>0?y(a):y([]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,Z.jsxs)("div",{className:d.container,children:[(0,Z.jsx)(u.Z,{title:"Purchase Request Search",onHeaderClick:ge({},"productForm"),bottonShow:!0,children:(0,Z.jsx)(c.Z,{template:K,rowwise:4,validate:$,onSubmit:function(e){console.log(e),e.random=Math.random(),je(e)},onCancel:e.onCancel,buttonName:"Search"})}),(0,Z.jsxs)(m.Z,{md:12,children:[(0,Z.jsx)(p.Z,{children:(0,Z.jsx)(x.Z,{md:3,children:(0,Z.jsx)(M.Z,{className:d.btn,onClick:ge({},"generatePo"),children:"Generate PO"})})}),(0,Z.jsx)(N.Z,{cols:h(ge,["edit","productForm","approvalForm","materialForm"]),data:f,includeCheck:1,rows:10,striped:!0,checkBoxEvent:function(e,t){if(t){var r,a=q.find((function(t){return t.material.materialId===e.material.materialId&&1487!=t.material.materialId}));null!==(r=a)&&void 0!==r&&r.purchaseRequestId?(a.requestQty=[].concat((0,l.Z)(a.requestQty),[e.materialQty]),a.requests=Number(a.requests)+1,a.requestItems=[].concat((0,l.Z)(a.requestItems),[Number(e.materialRequestId)]),a.expectedDate>e.expectedDate&&(a.dueDate=e.expectedDate),a.poQty=a.materialQty+e.materialQty,a.amount=0,a.gstAmt=0,Q(q.map((function(e){return e.purchaseRequestId===a.purchaseRequestId?a:e}))),function(e){throw new TypeError('"'+e+'" is read-only')}("alreadyAvail")):("Service"==e.purchaseRequest.requestType?(oe("Service_Purchase_Order"),e.amount=e.material.lastPurchasePrice*e.materialQty,e.gstAmt=(0*e.poQty*.01*e.material.gst).toFixed(2),e.itemName=e.specification):(e.amount=e.material.lastPurchasePrice*e.materialQty,e.gstAmt=(e.material.lastPurchasePrice*e.poQty*.01*e.material.gst).toFixed(2),e.itemName=e.material.materialName),e.poQty=e.materialQty-e.poQty,e.status="Awaiting_Approval",e.specs=e.specification,e.requestQty=[e.materialQty],e.gst=e.material.gst,e.uom=e.material.uom,e.requests=1,e.isRequest="Yes",e.requestItems=[Number(e.materialRequestId)],e.dueDate=e.expectedDate,e.unitPrice=e.material.lastPurchasePrice,e.specs="",Q((function(t){return[].concat((0,l.Z)(t),[e])})),console.log(q))}else Q(q.filter((function(t){return t.materialRequestId!==e.materialRequestId}))),console.log(q)}})]})]})};function $(e,t){var r=t.errors,a=t.setError,n=t.clearErrors;"Admin"===e.firstname?r.firstname||a("firstname",{type:"manual",message:"You cannot use this first name"}):r.firstname&&"manual"===r.firstname.type&&n("firstname")}}}]);
//# sourceMappingURL=305.b3b251b1.chunk.js.map